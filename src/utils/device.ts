// @ts-nocheck
// Device utilities import { Platform, Dimensions, StatusBar, PixelRatio } from 'react-native'; import DeviceInfo from 'react-native-device-info'; import { getStatusBarHeight } from 'react-native-status-bar-height'; import NetInfo from '@react-native-community/netinfo';  // Device types export interface DeviceInformation {   platform: 'ios' | 'android';   version: string;   model: string;   brand: string;   deviceId: string;   uniqueId: string;   systemName: string;   systemVersion: string;   bundleId: string;   buildNumber: string;   version: string;   readableVersion: string;   deviceName: string;   userAgent: string;   deviceCountry: string;   deviceLocale: string;   timezone: string;   isEmulator: boolean;   isTablet: boolean;   hasNotch: boolean;   hasDynamicIsland: boolean; }  export interface ScreenDimensions {   width: number;   height: number;   scale: number;   fontScale: number;   pixelRatio: number;   statusBarHeight: number;   isLandscape: boolean;   isPortrait: boolean;   isSmallScreen: boolean;   isMediumScreen: boolean;   isLargeScreen: boolean;   isTablet: boolean; }  export interface NetworkInformation {   isConnected: boolean;   type: string;   isWifiEnabled: boolean;   isInternetReachable: boolean;   details: any; }  export interface BatteryInformation {   level: number;   isCharging: boolean;   isLowPowerMode: boolean; }  export interface StorageInformation {   totalDiskCapacity: number;   freeDiskStorage: number;   usedDiskStorage: number;   totalMemory: number;   usedMemory: number; }  // Device detection utilities export const deviceDetection = {   // Platform checks   isIOS: Platform.OS === 'ios',   isAndroid: Platform.OS === 'android',      // Version checks   isIOS14OrLater: Platform.OS === 'ios' && parseInt(Platform.Version as string, 10) >= 14,   isIOS15OrLater: Platform.OS === 'ios' && parseInt(Platform.Version as string, 10) >= 15,   isAndroid10OrLater: Platform.OS === 'android' && Platform.Version >= 29,   isAndroid11OrLater: Platform.OS === 'android' && Platform.Version >= 30,   isAndroid12OrLater: Platform.OS === 'android' && Platform.Version >= 31,      // Device type checks   async isTablet(): Promise<boolean> {     try {       return await DeviceInfo.isTablet();     } catch (error) {       console.error('Error checking if device is tablet:', error);       return false;     }   },      async isEmulator(): Promise<boolean> {     try {       return await DeviceInfo.isEmulator();     } catch (error) {       console.error('Error checking if device is emulator:', error);       return false;     }   },      // Screen size checks   isSmallScreen(): boolean {     const { width, height } = Dimensions.get('window');     const screenSize = Math.min(width, height);     return screenSize < 375; // iPhone SE and smaller   },      isMediumScreen(): boolean {     const { width, height } = Dimensions.get('window');     const screenSize = Math.min(width, height);     return screenSize >= 375 && screenSize < 414; // iPhone 6/7/8 to iPhone 11 Pro   },      isLargeScreen(): boolean {     const { width, height } = Dimensions.get('window');     const screenSize = Math.min(width, height);     return screenSize >= 414; // iPhone 11 Pro Max and larger   },      // Notch detection   hasNotch(): boolean {     if (Platform.OS === 'ios') {       const { height, width } = Dimensions.get('window');       const statusBarHeight = getStatusBarHeight();              // iPhone X and later have status bar height > 20       return statusBarHeight > 20;     }          if (Platform.OS === 'android') {       const statusBarHeight = StatusBar.currentHeight || 0;       return statusBarHeight > 24; // Standard Android status bar is 24dp     }          return false;   },      // Dynamic Island detection (iPhone 14 Pro and later)   hasDynamicIsland(): boolean {     if (Platform.OS !== 'ios') return false;          const { height, width } = Dimensions.get('window');     const statusBarHeight = getStatusBarHeight();          // iPhone 14 Pro models have specific dimensions and status bar height     const isDynamicIslandDevice = (       (height === 852 && width === 393) || // iPhone 14 Pro       (height === 926 && width === 428)    // iPhone 14 Pro Max     ) && statusBarHeight >= 47;          return isDynamicIslandDevice;   }, };  // Screen utilities export const screenUtils = {   // Get screen dimensions   getDimensions(): ScreenDimensions {     const window = Dimensions.get('window');     const screen = Dimensions.get('screen');          return {       width: window.width,       height: window.height,       scale: PixelRatio.get(),       fontScale: PixelRatio.getFontScale(),       pixelRatio: PixelRatio.getPixelSizeForLayoutSize(1),       statusBarHeight: getStatusBarHeight(),       isLandscape: window.width > window.height,       isPortrait: window.height > window.width,       isSmallScreen: deviceDetection.isSmallScreen(),       isMediumScreen: deviceDetection.isMediumScreen(),       isLargeScreen: deviceDetection.isLargeScreen(),       isTablet: false, // Will be updated asynchronously     };   },      // Convert dp to px   dpToPx(dp: number): number {     return PixelRatio.getPixelSizeForLayoutSize(dp);   },      // Convert px to dp   pxToDp(px: number): number {     return px / PixelRatio.get();   },      // Get safe area insets   getSafeAreaInsets() {     const statusBarHeight = getStatusBarHeight();     const hasNotch = deviceDetection.hasNotch();          return {       top: statusBarHeight,       bottom: hasNotch ? 34 : 0, // Home indicator height on notched devices       left: 0,       right: 0,     };   },      // Responsive font size   responsiveFontSize(size: number): number {     const { width } = Dimensions.get('window');     const baseWidth = 375; // iPhone 6/7/8 width as base     const scale = width / baseWidth;     const newSize = size * scale;          // Ensure minimum and maximum font sizes     return Math.max(12, Math.min(newSize, size * 1.3));   },      // Responsive width   responsiveWidth(percentage: number): number {     const { width } = Dimensions.get('window');     return (percentage * width) / 100;   },      // Responsive height   responsiveHeight(percentage: number): number {     const { height } = Dimensions.get('window');     return (percentage * height) / 100;   }, };  // Device information service export class DeviceService {   private static instance: DeviceService;   private deviceInfo: Partial<DeviceInformation> = {};   private networkInfo: Partial<NetworkInformation> = {};      static getInstance(): DeviceService {     if (!DeviceService.instance) {       DeviceService.instance = new DeviceService();     }     return DeviceService.instance;   }      // Initialize device information   async initialize(): Promise<void> {     try {       await this.loadDeviceInformation();       await this.setupNetworkListener();     } catch (error) {       console.error('Error initializing device service:', error);     }   }      // Load device information   private async loadDeviceInformation(): Promise<void> {     try {       const [model, brand, deviceId, uniqueId, systemName, systemVersion, bundleId, buildNumber, version, readableVersion, deviceName, userAgent, deviceCountry, deviceLocale, timezone, isEmulator, isTablet] = await Promise.all([         DeviceInfo.getModel(),         DeviceInfo.getBrand(),         DeviceInfo.getDeviceId(),         DeviceInfo.getUniqueId(),         DeviceInfo.getSystemName(),         DeviceInfo.getSystemVersion(),         DeviceInfo.getBundleId(),         DeviceInfo.getBuildNumber(),         DeviceInfo.getVersion(),         DeviceInfo.getReadableVersion(),         DeviceInfo.getDeviceName(),         DeviceInfo.getUserAgent(),         DeviceInfo.getDeviceCountry(),         DeviceInfo.getDeviceLocale(),         DeviceInfo.getTimezone(),         DeviceInfo.isEmulator(),         DeviceInfo.isTablet(),       ]);              this.deviceInfo = {         platform: Platform.OS as 'ios' | 'android',         version: Platform.Version.toString(),         model,         brand,         deviceId,         uniqueId,         systemName,         systemVersion,         bundleId,         buildNumber,         version,         readableVersion,         deviceName,         userAgent,         deviceCountry,         deviceLocale,         timezone,         isEmulator,         isTablet,         hasNotch: deviceDetection.hasNotch(),         hasDynamicIsland: deviceDetection.hasDynamicIsland(),       };     } catch (error) {       console.error('Error loading device information:', error);     }   }      // Setup network listener   private async setupNetworkListener(): Promise<void> {     try {       // Get initial network state       const netInfo = await NetInfo.fetch();       this.updateNetworkInfo(netInfo);              // Listen for network changes       NetInfo.addEventListener((state) => {         this.updateNetworkInfo(state);       });     } catch (error) {       console.error('Error setting up network listener:', error);     }   }      // Update network information   private updateNetworkInfo(netInfo: any): void {     this.networkInfo = {       isConnected: netInfo.isConnected,       type: netInfo.type,       isWifiEnabled: netInfo.isWifiEnabled,       isInternetReachable: netInfo.isInternetReachable,       details: netInfo.details,     };   }      // Get device information   getDeviceInfo(): Partial<DeviceInformation> {     return { ...this.deviceInfo };   }      // Get network information   getNetworkInfo(): Partial<NetworkInformation> {     return { ...this.networkInfo };   }      // Get battery information   async getBatteryInfo(): Promise<BatteryInformation> {     try {       const [level, isCharging, isLowPowerMode] = await Promise.all([         DeviceInfo.getBatteryLevel(),         DeviceInfo.isBatteryCharging(),         DeviceInfo.isPowerSaveMode(),       ]);              return {         level: Math.round(level * 100),         isCharging,         isLowPowerMode,       };     } catch (error) {       console.error('Error getting battery info:', error);       return {         level: 0,         isCharging: false,         isLowPowerMode: false,       };     }   }      // Get storage information   async getStorageInfo(): Promise<StorageInformation> {     try {       const [totalDiskCapacity, freeDiskStorage, totalMemory, usedMemory] = await Promise.all([         DeviceInfo.getTotalDiskCapacity(),         DeviceInfo.getFreeDiskStorage(),         DeviceInfo.getTotalMemory(),         DeviceInfo.getUsedMemory(),       ]);              return {         totalDiskCapacity,         freeDiskStorage,         usedDiskStorage: totalDiskCapacity - freeDiskStorage,         totalMemory,         usedMemory,       };     } catch (error) {       console.error('Error getting storage info:', error);       return {         totalDiskCapacity: 0,         freeDiskStorage: 0,         usedDiskStorage: 0,         totalMemory: 0,         usedMemory: 0,       };     }   }      // Check if device meets minimum requirements   checkMinimumRequirements(): {     meets: boolean;     issues: string[];   } {     const issues: string[] = [];          // Check OS version     if (Platform.OS === 'ios' && parseInt(Platform.Version as string, 10) < 12) {       issues.push('iOS version must be 12.0 or later');     }          if (Platform.OS === 'android' && Platform.Version < 23) {       issues.push('Android version must be 6.0 (API level 23) or later');     }          // Check screen size     const { width, height } = Dimensions.get('window');     if (Math.min(width, height) < 320) {       issues.push('Screen size too small (minimum 320px)');     }          // Check memory (if available)     // This would require additional native modules for accurate memory checking          return {       meets: issues.length === 0,       issues,     };   }      // Get device fingerprint for analytics   getDeviceFingerprint(): string {     const info = this.getDeviceInfo();     const screen = screenUtils.getDimensions();          const fingerprint = [       info.platform,       info.systemVersion,       info.model,       info.brand,       screen.width,       screen.height,       screen.scale,       info.deviceLocale,       info.timezone,     ].join('|');          return Buffer.from(fingerprint).toString('base64');   } }  // Device utilities export const deviceUtils = {   // Format storage size   formatStorageSize(bytes: number): string {     const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];     if (bytes === 0) return '0 Bytes';          const i = Math.floor(Math.log(bytes) / Math.log(1024));     return Math.round(bytes / Math.pow(1024, i) * 100) / 100 + ' ' + sizes[i];   },      // Format battery level   formatBatteryLevel(level: number): string {     return `${level}%`;   },      // Get device type string   getDeviceTypeString(): string {     if (deviceDetection.isTablet()) {       return 'Tablet';     }          if (deviceDetection.isSmallScreen()) {       return 'Small Phone';     }          if (deviceDetection.isMediumScreen()) {       return 'Medium Phone';     }          if (deviceDetection.isLargeScreen()) {       return 'Large Phone';     }          return 'Phone';   },      // Get network type string   getNetworkTypeString(type: string): string {     const typeMap: Record<string, string> = {       wifi: 'Wi-Fi',       cellular: 'Cellular',       ethernet: 'Ethernet',       bluetooth: 'Bluetooth',       wimax: 'WiMAX',       vpn: 'VPN',       other: 'Other',       unknown: 'Unknown',       none: 'No Connection',     };          return typeMap[type] || 'Unknown';   },      // Check if device supports feature   supportsFeature(feature: string): boolean {     const featureSupport: Record<string, boolean> = {       // iOS features       faceId: Platform.OS === 'ios' && parseInt(Platform.Version as string, 10) >= 11,       touchId: Platform.OS === 'ios' && parseInt(Platform.Version as string, 10) >= 8,              // Android features       fingerprint: Platform.OS === 'android' && Platform.Version >= 23,              // Common features       camera: true,       location: true,       notifications: true,       backgroundLocation: Platform.OS === 'android' ? Platform.Version >= 29 : true,     };          return featureSupport[feature] ?? false;   }, };  // Export device service instance export const deviceService = DeviceService.getInstance();  // Export default export default {   DeviceService,   deviceService,   deviceDetection,   screenUtils,   deviceUtils, };

