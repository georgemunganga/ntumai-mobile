import React from 'react';\nimport {\n  View,\n  Text,\n  TouchableOpacity,\n  ScrollView,\n  Image,\n  FlatList,\n} from 'react-native';\nimport { useRouter } from 'expo-router';\nimport { useCartStore } from '../../src/store';\nimport { Feather } from '@expo/vector-icons';\n\nexport default function Cart() {\n  const router = useRouter();\n  const { items, totalPrice, totalItems, removeItem, updateQuantity, discount, deliveryFee } = useCartStore();\n\n  const subtotal = totalPrice;\n  const tax = Math.round(subtotal * 0.1); // 10% tax\n  const total = subtotal + deliveryFee + tax - discount;\n\n  if (items.length === 0) {\n    return (\n      <View className=\"flex-1 bg-white\">\n        {/* Header */}\n        <View className=\"px-6 py-4 border-b border-gray-200 flex-row items-center\">\n          <TouchableOpacity onPress={() => router.back()} className=\"mr-4\">\n            <Feather name=\"chevron-left\" size={24} color=\"#1F2937\" />\n          </TouchableOpacity>\n          <Text className=\"text-2xl font-bold text-gray-900\">Shopping Cart</Text>\n        </View>\n\n        {/* Empty State */}\n        <View className=\"flex-1 items-center justify-center\">\n          <Feather name=\"shopping-cart\" size={64} color=\"#D1D5DB\" />\n          <Text className=\"text-2xl font-bold text-gray-900 mt-4\">Your cart is empty</Text>\n          <Text className=\"text-gray-600 text-center mt-2 px-6\">\n            Add items from the marketplace to get started\n          </Text>\n          <TouchableOpacity\n            onPress={() => router.push('/(customer)/Marketplace')}\n            className=\"bg-green-600 rounded-lg px-8 py-4 mt-8\"\n          >\n            <Text className=\"text-white font-bold text-lg\">Continue Shopping</Text>\n          </TouchableOpacity>\n        </View>\n      </View>\n    );\n  }\n\n  return (\n    <View className=\"flex-1 bg-white\">\n      {/* Header */}\n      <View className=\"px-6 py-4 border-b border-gray-200 flex-row items-center justify-between\">\n        <View className=\"flex-row items-center\">\n          <TouchableOpacity onPress={() => router.back()} className=\"mr-4\">\n            <Feather name=\"chevron-left\" size={24} color=\"#1F2937\" />\n          </TouchableOpacity>\n          <Text className=\"text-2xl font-bold text-gray-900\">Shopping Cart</Text>\n        </View>\n        <View className=\"bg-green-100 rounded-full px-3 py-1\">\n          <Text className=\"text-green-700 font-bold text-sm\">{totalItems} items</Text>\n        </View>\n      </View>\n\n      <ScrollView className=\"flex-1\">\n        {/* Cart Items */}\n        <View className=\"px-6 py-6\">\n          <FlatList\n            data={items}\n            keyExtractor={(item) => item.product.id}\n            scrollEnabled={false}\n            renderItem={({ item }) => (\n              <View className=\"bg-gray-50 rounded-lg p-4 mb-4 flex-row items-center\">\n                <Image\n                  source={{ uri: item.product.image }}\n                  className=\"w-20 h-20 rounded-lg mr-4\"\n                />\n                <View className=\"flex-1\">\n                  <Text className=\"text-lg font-bold text-gray-900 mb-1\">{item.product.name}</Text>\n                  <Text className=\"text-green-600 font-bold\">{item.product.price}K</Text>\n                </View>\n                <View className=\"flex-row items-center gap-2\">\n                  <TouchableOpacity\n                    onPress={() => updateQuantity(item.product.id, Math.max(1, item.quantity - 1))}\n                    className=\"w-8 h-8 rounded-full border border-gray-300 items-center justify-center\"\n                  >\n                    <Text className=\"text-gray-600 font-bold\">âˆ’</Text>\n                  </TouchableOpacity>\n                  <Text className=\"w-6 text-center font-bold text-gray-900\">{item.quantity}</Text>\n                  <TouchableOpacity\n                    onPress={() => updateQuantity(item.product.id, item.quantity + 1)}\n                    className=\"w-8 h-8 rounded-full border border-gray-300 items-center justify-center\"\n                  >\n                    <Text className=\"text-gray-600 font-bold\">+</Text>\n                  </TouchableOpacity>\n                  <TouchableOpacity\n                    onPress={() => removeItem(item.product.id)}\n                    className=\"ml-3\"\n                  >\n                    <Feather name=\"trash-2\" size={20} color=\"#EF4444\" />\n                  </TouchableOpacity>\n                </View>\n              </View>\n            )}\n          />\n        </View>\n\n        {/* Special Instructions */}\n        <View className=\"px-6 py-4 border-t border-gray-200\">\n          <Text className=\"text-sm font-semibold text-gray-700 mb-2\">Special Instructions</Text>\n          <View className=\"border border-gray-300 rounded-lg p-3 bg-gray-50\">\n            <Text className=\"text-gray-600\">Add any special requests or dietary requirements...</Text>\n          </View>\n        </View>\n      </ScrollView>\n\n      {/* Summary and Checkout */}\n      <View className=\"border-t border-gray-200 px-6 py-6 bg-white\">\n        {/* Price Breakdown */}\n        <View className=\"mb-6 gap-3\">\n          <View className=\"flex-row items-center justify-between\">\n            <Text className=\"text-gray-600\">Subtotal</Text>\n            <Text className=\"text-gray-900 font-semibold\">{subtotal}K</Text>\n          </View>\n          <View className=\"flex-row items-center justify-between\">\n            <Text className=\"text-gray-600\">Tax (10%)</Text>\n            <Text className=\"text-gray-900 font-semibold\">{tax}K</Text>\n          </View>\n          <View className=\"flex-row items-center justify-between\">\n            <Text className=\"text-gray-600\">Delivery Fee</Text>\n            <Text className=\"text-gray-900 font-semibold\">{deliveryFee}K</Text>\n          </View>\n          {discount > 0 && (\n            <View className=\"flex-row items-center justify-between\">\n              <Text className=\"text-green-600\">Discount</Text>\n              <Text className=\"text-green-600 font-semibold\">-{discount}K</Text>\n            </View>\n          )}\n        </View>\n\n        {/* Total */}\n        <View className=\"bg-gray-50 rounded-lg p-4 mb-6 flex-row items-center justify-between\">\n          <Text className=\"text-lg font-bold text-gray-900\">Total</Text>\n          <Text className=\"text-2xl font-bold text-green-600\">{total}K</Text>\n        </View>\n\n        {/* Checkout Button */}\n        <TouchableOpacity\n          onPress={() => router.push('/(customer)/Checkout')}\n          className=\"bg-green-600 rounded-lg py-4\"\n        >\n          <Text className=\"text-white text-center font-bold text-lg\">Proceed to Checkout</Text>\n        </TouchableOpacity>\n\n        {/* Continue Shopping */}\n        <TouchableOpacity\n          onPress={() => router.push('/(customer)/Marketplace')}\n          className=\"py-4\"\n        >\n          <Text className=\"text-center text-gray-600 font-semibold\">Continue Shopping</Text>\n        </TouchableOpacity>\n      </View>\n    </View>\n  );\n}\n
