import React, { useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  ScrollView,\n  TouchableOpacity,\n  TextInput,\n  Alert,\n  ActivityIndicator,\n} from 'react-native';\nimport { useRouter } from 'expo-router';\nimport { Ionicons } from '@expo/vector-icons';\nimport { shoppingListMockService } from '../../src/api/mockServices.extended';\n\ninterface ShoppingList {\n  id: string;\n  name: string;\n  itemCount: number;\n  lastUsed: string;\n  estimatedCost: number;\n}\n\nexport default function ShoppingListsScreen() {\n  const router = useRouter();\n  const [lists, setLists] = useState<ShoppingList[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [showCreateForm, setShowCreateForm] = useState(false);\n  const [newListName, setNewListName] = useState('');\n\n  useEffect(() => {\n    loadLists();\n  }, []);\n\n  const loadLists = async () => {\n    try {\n      const response = await shoppingListMockService.getLists('user_1');\n      if (response.success) {\n        setLists(response.data);\n      }\n    } catch (error) {\n      Alert.alert('Error', 'Failed to load shopping lists');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCreateList = async () => {\n    if (!newListName.trim()) {\n      Alert.alert('Error', 'Please enter a list name');\n      return;\n    }\n\n    try {\n      const response = await shoppingListMockService.createList({\n        name: newListName,\n        items: [],\n      });\n      if (response.success) {\n        setLists([...lists, response.data]);\n        setNewListName('');\n        setShowCreateForm(false);\n        Alert.alert('Success', 'Shopping list created');\n      }\n    } catch (error) {\n      Alert.alert('Error', 'Failed to create list');\n    }\n  };\n\n  const handleUseList = (list: ShoppingList) => {\n    router.push({\n      pathname: '/(customer)/DoTaskScreen',\n      params: {\n        shoppingListId: list.id,\n        shoppingListName: list.name,\n      },\n    });\n  };\n\n  const handleDeleteList = (listId: string) => {\n    Alert.alert('Delete List', 'Are you sure you want to delete this list?', [\n      { text: 'Cancel', style: 'cancel' },\n      {\n        text: 'Delete',\n        onPress: () => {\n          setLists(lists.filter((l) => l.id !== listId));\n        },\n        style: 'destructive',\n      },\n    ]);\n  };\n\n  if (loading) {\n    return (\n      <View className=\"flex-1 justify-center items-center bg-white\">\n        <ActivityIndicator size=\"large\" color=\"#FF6B35\" />\n      </View>\n    );\n  }\n\n  return (\n    <View className=\"flex-1 bg-gray-50\">\n      {/* Header */}\n      <View className=\"bg-white border-b border-gray-200 px-4 py-4\">\n        <Text className=\"text-2xl font-bold text-gray-900\">Shopping Lists</Text>\n        <Text className=\"text-sm text-gray-600 mt-1\">\n          Create and reuse shopping lists for errands\n        </Text>\n      </View>\n\n      <ScrollView className=\"flex-1 px-4 py-4\" showsVerticalScrollIndicator={false}>\n        {/* Create New List Form */}\n        {showCreateForm && (\n          <View className=\"bg-white rounded-lg p-4 mb-4 border border-blue-200\">\n            <Text className=\"text-lg font-bold text-gray-900 mb-3\">Create New List</Text>\n            <TextInput\n              value={newListName}\n              onChangeText={setNewListName}\n              placeholder=\"List name (e.g., Weekly Groceries)\"\n              className=\"bg-gray-100 rounded-lg px-4 py-3 text-gray-900 mb-3\"\n              placeholderTextColor=\"#999\"\n            />\n            <View className=\"flex-row gap-2\">\n              <TouchableOpacity\n                onPress={handleCreateList}\n                className=\"flex-1 bg-blue-500 py-2 rounded-lg\"\n              >\n                <Text className=\"text-center text-white font-semibold\">Create</Text>\n              </TouchableOpacity>\n              <TouchableOpacity\n                onPress={() => {\n                  setShowCreateForm(false);\n                  setNewListName('');\n                }}\n                className=\"flex-1 bg-gray-200 py-2 rounded-lg\"\n              >\n                <Text className=\"text-center text-gray-900 font-semibold\">Cancel</Text>\n              </TouchableOpacity>\n            </View>\n          </View>\n        )}\n\n        {/* Lists */}\n        {lists.length === 0 ? (\n          <View className=\"items-center justify-center py-12\">\n            <Ionicons name=\"list\" size={48} color=\"#D1D5DB\" />\n            <Text className=\"text-gray-600 mt-4 text-center\">\n              No shopping lists yet. Create one to get started!\n            </Text>\n          </View>\n        ) : (\n          lists.map((list) => (\n            <View\n              key={list.id}\n              className=\"bg-white rounded-lg p-4 mb-3 border border-gray-200\"\n            >\n              <View className=\"flex-row justify-between items-start mb-2\">\n                <View className=\"flex-1\">\n                  <Text className=\"text-lg font-bold text-gray-900\">{list.name}</Text>\n                  <Text className=\"text-sm text-gray-600 mt-1\">\n                    {list.itemCount} items • ₭{list.estimatedCost.toFixed(2)}\n                  </Text>\n                </View>\n                <TouchableOpacity\n                  onPress={() => handleDeleteList(list.id)}\n                  className=\"p-2\"\n                >\n                  <Ionicons name=\"trash\" size={20} color=\"#EF4444\" />\n                </TouchableOpacity>\n              </View>\n\n              <Text className=\"text-xs text-gray-500 mb-3\">\n                Last used: {new Date(list.lastUsed).toLocaleDateString()}\n              </Text>\n\n              <TouchableOpacity\n                onPress={() => handleUseList(list)}\n                className=\"bg-blue-500 py-2 rounded-lg\"\n              >\n                <Text className=\"text-center text-white font-semibold\">Use This List</Text>\n              </TouchableOpacity>\n            </View>\n          ))\n        )}\n      </ScrollView>\n\n      {/* Create Button */}\n      {!showCreateForm && (\n        <View className=\"px-4 py-4 border-t border-gray-200 bg-white\">\n          <TouchableOpacity\n            onPress={() => setShowCreateForm(true)}\n            className=\"bg-blue-500 py-3 rounded-lg flex-row items-center justify-center\"\n          >\n            <Ionicons name=\"add\" size={24} color=\"white\" />\n            <Text className=\"text-white font-bold ml-2\">Create New List</Text>\n          </TouchableOpacity>\n        </View>\n      )}\n    </View>\n  );\n}\n
